<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:sans-serif;background:#f5f5f5;margin:0;padding:10px}
h2{text-align:center}
.controls{text-align:center;margin-bottom:10px}
select{padding:6px;font-size:16px}

table{border-collapse:collapse;width:100%;background:#fff}
th,td{border:1px solid #ccc;padding:4px;text-align:center;font-size:13px}
th{background:#eee;position:sticky;top:0}
.section{background:#dfefff;font-weight:bold}
.day{font-size:11px;color:#555}
.cell{cursor:pointer;font-weight:bold}

.v1{background:#e3f2fd}
.v2{background:#fce4ec}
.v3{background:#e8f5e9}
.v4{background:#fff3e0}
.v5{background:#ede7f6}
.v6{background:#f3e5f5}
.v7{background:#e0f2f1}
.v8{background:#fbe9e7}
</style>
</head>

<body>

<h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‚Äì‡∏®‡∏∏‡∏Å‡∏£‡πå)</h2>

<div class="controls">
  ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:
  <select id="month"></select>
  ‡∏õ‡∏µ (‡∏û.‡∏®.):
  <select id="year"></select>
</div>

<table id="table"></table>

<script>
// ===== ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ =====
const council = [
  {name:"‡∏ô‡∏≤‡∏¢ ‡∏ì‡∏±‡∏ê‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏Å‡∏ï‡∏∏‡∏ô‡∏≠‡∏Å",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏¢ ‡∏Å‡∏§‡∏ï‡∏†‡∏≤‡∏™ ‡∏ô‡∏≤‡∏°‡∏û‡∏∞‡πÄ‡∏ô‡∏≤‡∏ß‡πå",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏û‡∏¥‡∏¢‡∏î‡∏≤ ‡∏ß‡∏á‡∏®‡πå‡πÉ‡∏´‡∏ç‡πà",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏Å‡∏±‡∏ô‡∏Å‡∏°‡∏• ‡∏°‡∏π‡∏•‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏û‡∏£‡∏£‡∏ì‡∏¥‡∏†‡∏≤ ‡∏Ñ‡∏≥‡∏™‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏û‡∏¥‡∏ä‡∏ç‡∏≤ ‡∏ã‡πâ‡∏≤‡∏¢‡∏à‡∏±‡∏ô‡∏ó‡∏∂‡∏Å",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ì‡∏¥‡∏ä‡∏≤‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏ô‡∏≤‡∏Ñ‡∏´‡∏°‡∏∑‡πà‡∏ô‡πÑ‡∏ß‡∏¢‡πå",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏¢ ‡∏†‡∏≤‡∏ì‡∏∏‡∏û‡∏á‡∏©‡πå ‡∏î‡∏±‡∏ô‡πÑ‡∏ò‡∏™‡∏á",room:"5/1"},
  {name:"‡∏ô‡∏≤‡∏¢ ‡πÄ‡∏õ‡∏£‡∏°‡∏≠‡∏≤‡∏ô‡∏ô‡∏ó‡πå ‡πÄ‡∏ï‡∏µ‡πâ‡∏¢‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™",room:"5/1"}
];

const subcommittee = [
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ß‡∏£‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏Å‡∏•‡∏¥‡πà‡∏ô",room:"4/1"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏™‡∏¥‡∏£‡∏¥‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏Ç‡∏≠‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏•‡∏≤‡∏á",room:"4/1"},
  {name:"‡∏ô‡∏≤‡∏¢ ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞ ‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡πÄ‡∏®‡∏©",room:"4/2"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ò‡∏ô‡∏Å‡∏°‡∏• ‡∏®‡∏£‡∏µ‡∏ò‡∏≤‡∏ß‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå",room:"4/2"},
  {name:"‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏õ‡∏≤‡∏£‡∏¥‡∏â‡∏±‡∏ï‡∏£ ‡∏ú‡∏∂‡πà‡∏á‡∏î‡πà‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",room:"4/2"}
];

// ===== ‡∏£‡∏∞‡∏ö‡∏ö =====
const monthNames=["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô",
"‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
const dayNames=["‡∏≠‡∏≤","‡∏à","‡∏≠","‡∏û","‡∏û‡∏§","‡∏®","‡∏™"];

const mSel=document.getElementById("month");
const ySel=document.getElementById("year");
const table=document.getElementById("table");

monthNames.forEach((m,i)=>mSel.innerHTML+=`<option value="${i}">${m}</option>`);
for(let y=2567;y<=2575;y++) ySel.innerHTML+=`<option>${y}</option>`;
mSel.value=new Date().getMonth();
ySel.value=new Date().getFullYear()+543;

function render(){
  table.innerHTML="";
  const m=+mSel.value;
  const y=+ySel.value-543;

  const days=[];
  const max=new Date(y,m+1,0).getDate();
  for(let d=1;d<=max;d++){
    const dt=new Date(y,m,d);
    if(dt.getDay()!=0 && dt.getDay()!=6){
      days.push({d,day:dt.getDay()});
    }
  }

  let head="<tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏´‡πâ‡∏≠‡∏á</th>";
  days.forEach(x=>head+=`<th>${x.d}<div class="day">${dayNames[x.day]}</div></th>`);
  head+="</tr>";
  table.innerHTML+=head;

  addSection("‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",council,days);
  addSection("‡∏≠‡∏ô‡∏∏‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£",subcommittee,days);
}

function addSection(title,list,days){
  table.innerHTML+=`<tr class="section"><td colspan="${days.length+2}">${title}</td></tr>`;
  list.forEach((s,index)=>{
    let r=`<tr>
      <td>${index+1}. ${s.name}</td>
      <td>${s.room}</td>`;
    days.forEach((_,i)=>{
      const v=i%8+1;
      r+=`<td class="cell v${v}" onclick="edit(this)">${v}</td>`;
    });
    r+="</tr>";
    table.innerHTML+=r;
  });
}

// üî• ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô‡πÄ‡∏•‡∏Ç‡∏ï‡πà‡∏≠‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
function edit(td){
  let start = parseInt(prompt("‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡πÄ‡∏ß‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (1-8)", td.innerText));
  if(start < 1 || start > 8) return;

  const row = td.parentElement;
  const cells = Array.from(row.querySelectorAll(".cell"));

  let index = cells.indexOf(td);
  let value = start;

  for(let i=index;i<cells.length;i++){
    cells[i].innerText = value;
    cells[i].className = "cell v" + value;
    value++;
    if(value > 8) value = 1;
  }
}

mSel.onchange=render;
ySel.onchange=render;
render();
</script>

</body>
</html>
